FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGhlbGxvLXNucy1hcGIKZGVzY3JpcHRpb246IGRlcGxveXMgaGVs\
bG8tc25zIHdlYiBhcHBsaWNhdGlvbgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1l\
dGFkYXRhOgogIGRpc3BsYXlOYW1lOiBIZWxsbyBTTlMgKEFQQikKICBsb25nRGVzY3JpcHRpb246\
IEEgc2FtcGxlIEFQQiB3aGljaCBkZXBsb3lzIGEgY29udGFpbmVyaXplZCBIZWxsbyBTTlMgd2Vi\
IGFwcGxpY2F0aW9uCiAgZGVwZW5kZW5jaWVzOiBbJ2RvY2tlci5pby9hcGJ0ZXN0aW5nL2hlbGxv\
LXNuczpsYXRlc3QnXQpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBB\
IHNhbXBsZSBBUEIgd2hpY2ggZGVwbG95cyBIZWxsbyBTTlMKICAgIGZyZWU6IFRydWUKICAgIG1l\
dGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246\
IFRoaXMgcGxhbiBkZXBsb3lzIGEgUHl0aG9uIHdlYiBhcHBsaWNhdGlvbiBkaXNwbGF5aW5nIEhl\
bGxvIFNOUwogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogW10K"

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
