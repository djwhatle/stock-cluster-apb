FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN0b2NrLWNsdXN0ZXItYXBiCmRlc2NyaXB0aW9uOiBkZXBsb3lz\
IHN0b2NrLWNsdXN0ZXIgd2ViIGFwcGxpY2F0aW9uIGFuZCB3b3JrZXIKYmluZGFibGU6IEZhbHNl\
CmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogU3RvY2sgQ2x1c3RlciBB\
bmFseXNpcyAoQVBCKQogIGxvbmdEZXNjcmlwdGlvbjogQW4gQVBCIHdoaWNoIGRlcGxveXMgYSBz\
dG9jayBjYXRlZ29yaXplciB3ZWIgYXBwIGFuZCB3b3JrZXIgdGFraW5nIGFkdmFudGFnZSBvZiBz\
a2xlYXJuIGFuZCBBV1Mgc2VydmljZXMgKFJEUywgU1FTLCBTTlMsIFMzKQogIGRlcGVuZGVuY2ll\
czogWydkb2NrZXIuaW8vZGp3aGF0bGUvc3RvY2stY2x1c3Rlci13ZWJhcHA6bGF0ZXN0JywgJ2Rv\
Y2tlci5pby9kandoYXRsZS9zdG9jay1jbHVzdGVyLXdvcmtlcjpsYXRlc3QnXQpwbGFuczoKICAt\
IG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBBbiBBUEIgd2hpY2ggZGVwbG95cyBhIHN0\
b2NrIGNhdGVnb3JpemVyIG1hY2hpbmUtbGVhcm5pbmcgd2ViIGFwcGxpY2F0aW9uIGFuZCB3b3Jr\
ZXIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVs\
dAogICAgICBsb25nRGVzY3JpcHRpb246IERlcGxveXMgYSBzdG9jayBjYXRlZ29yaXplciBtYWNo\
aW5lLWxlYXJuaW5nIHdlYiBhcHBsaWNhdGlvbiB0YWtpbmcgYWR2YW50YWdlIG9mIHNrbGVhcm4g\
YW5kIEFXUyBzZXJ2aWNlcyAoUkRTLCBTUVMsIFNOUywgUzMpCiAgICAgIGNvc3Q6ICQwLjAwCiAg\
ICBwYXJhbWV0ZXJzOiBbXQo="

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
