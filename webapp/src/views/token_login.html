<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Hello SNS!</title>

  <link rel='stylesheet' href='/static/css/main.css' />
  <link rel='stylesheet' href='/static/css/bootstrap.min.css' />

  <script src="/static/js/jquery-3.2.1.min.js"></script>
</head>
<body>
  <div class='grey-block'></div>
  <section class='container'>
    <form class="form-signin" onsubmit="return false;">
      <h3 class="form-signin-heading">Sign in with single-use code</h3>
      <input type="email" id="inputEmail" class="form-control" placeholder="admin@redhat.com" required="" disabled="">
      <label for="inputPassword" class="sr-only">Single-use code</label>
      <input type="text" id="inputPassword" class="form-control password-control" placeholder="Single-use code">
      <button id="btnSignIn" class="btn btn-lg btn-primary btn-block">Sign in</button>
      <button id="btnSendCode" class="btn btn-md btn-secondary btn-block">Send a code to my phone</button>

    </form>
    <footer class="logo-footer">
      <div class="logo"><a href="https://www.openshift.com/"></a></div>
    </footer>
  </section>

  <div id="snackbar"></div>

  <script language="javascript">
    var generated_token = "faketoken"

    $("#btnSendCode").click(function() {
      response = $.get("/token_generate", function() {
        generated_token = response.responseJSON['generated_token'];
      });
      $("#snackbar").text("Sending text message...");
      var x = document.getElementById("snackbar");
      x.className = "show";
      setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    });

    $("#btnSignIn").click(function() {
      if ($("#inputPassword").val() == generated_token) {
        $("#inputPassword").removeClass("invalid-input");
        $("#snackbar").text("Sign in successful! Redirecting...");
        var x = document.getElementById("snackbar");
        x.className = "show";
        setTimeout(function(){
           x.className = x.className.replace("show", "");
           window.location.replace("/admin_panel");
         }, 1500);
      }
      else {
        $("#inputPassword").addClass("invalid-input");
        $("#snackbar").text("Invalid code entered.");
        var x = document.getElementById("snackbar");
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
      }
    });
  </script>

</body>
</html>
